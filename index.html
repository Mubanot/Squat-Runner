<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#111827" />
  <title>ABF Middle Day Logger</title>
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" type="image/png" sizes="192x192" href="./icons/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="./icons/icon-512.png" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <main class="app">
    <header class="card">
      <h1>ABF Middle Day Logger + Rest Timer</h1>
      <p id="todayDate" class="muted"></p>
    </header>

    <section class="card" aria-labelledby="settingsTitle">
      <h2 id="settingsTitle">Settings</h2>
      <div class="grid two">
        <label>Rounds <input id="roundsInput" type="number" min="1" step="1" /></label>
        <label>Transition Rest (sec) <input id="transitionRestInput" type="number" min="0" step="1" /></label>
        <label>Between-Round Rest (sec) <input id="betweenRoundRestInput" type="number" min="0" step="1" /></label>
        <label>Default Unit
          <select id="defaultUnitInput">
            <option value="lb">lb</option>
            <option value="kg">kg</option>
          </select>
        </label>
        <label class="inline-toggle"><input id="autoAdvanceInput" type="checkbox" /><span>Auto-advance after rest</span></label>
      </div>
    </section>

    <section class="card" aria-labelledby="planTitle">
      <div class="row between">
        <h2 id="planTitle">Plan Editor</h2>
        <button id="addMovementBtn" type="button">Add Movement</button>
      </div>
      <div id="movementList" class="stack"></div>
    </section>

    <section class="card" aria-labelledby="activeTitle">
      <h2 id="activeTitle">Active Set</h2>
      <p id="activeMeta" class="muted"></p>
      <p id="activeMovement" class="active-movement"></p>

      <div class="grid two">
        <label>Weight (optional) <input id="weightInput" type="number" min="0" step="0.5" inputmode="decimal" /></label>
        <label>Unit
          <select id="unitInput"><option value="lb">lb</option><option value="kg">kg</option></select>
        </label>
        <label>Rep Type
          <select id="repTypeInput"><option value="reps">reps</option><option value="seconds">seconds</option><option value="meters">meters</option></select>
        </label>
        <label>Value <input id="valueInput" type="number" min="0" step="1" inputmode="numeric" required /></label>
        <label class="full">Notes (optional) <input id="notesInput" type="text" maxlength="200" /></label>
      </div>

      <div id="readyActions" class="row">
        <button id="setDoneBtn" class="primary" type="button">Set Done -> Start Rest</button>
      </div>

      <div id="restPanel" class="rest hidden" aria-live="polite">
        <p>Resting</p>
        <p id="restCountdown" class="countdown">00:00</p>
        <div class="row">
          <button id="skipRestBtn" type="button">Skip Rest</button>
          <button id="nextSetBtn" type="button" class="hidden">Next Set</button>
        </div>
      </div>
    </section>

    <section class="card" aria-labelledby="summaryTitle">
      <h2 id="summaryTitle">Summary</h2>
      <p id="totalSets"></p>
      <div id="summaryMovements" class="stack"></div>
    </section>

    <section class="card" aria-labelledby="logTitle">
      <div class="row between">
        <h2 id="logTitle">Log</h2>
        <div class="row">
          <button id="exportCsvBtn" type="button">Export CSV</button>
          <button id="exportJsonBtn" type="button">Export JSON</button>
          <button id="clearWorkoutBtn" class="danger" type="button">Clear Workout</button>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>Timestamp</th><th>Round</th><th>Movement</th><th>Weight</th><th>Unit</th><th>Type</th><th>Value</th><th>Notes</th><th>Actions</th></tr>
          </thead>
          <tbody id="logBody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <template id="movementRowTemplate">
    <div class="movement-row">
      <label>Name <input data-field="name" type="text" /></label>
      <label>Target <input data-field="target" type="text" /></label>
      <div class="row">
        <button data-action="up" type="button">Up</button>
        <button data-action="down" type="button">Down</button>
        <button data-action="remove" type="button" class="danger">Remove</button>
      </div>
    </div>
  </template>

  <script src="./app.js"></script>
</body>
</html>
